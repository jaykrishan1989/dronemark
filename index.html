<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DRONEMARK</title>
<link href="css/singlePageTemplate.css" rel="stylesheet" type="text/css">
<!-- Leaflet CSS for OpenStreetMap -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<!--The following script tag downloads a font from the Adobe Edge Web Fonts server for use within the web page. We recommend that you do not modify it.-->
<script>var __adobewebfontsappname__="dreamweaver"</script>
<script src="http://use.edgefonts.net/source-sans-pro:n2:default.js" type="text/javascript"></script>
<!-- Leaflet JS for OpenStreetMap -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- Main Container -->
<div class="container"> 
  <!-- Navigation -->
  <header> <a href="">
    <h4 class="logo">DRONEMARK</h4>
    </a>
    <nav>
      <ul>
        <li><a href="#hero">HOME</a></li>
        <li><a href="#about">ABOUT</a></li>
        <li><a href="#contact">CONTACT</a></li>
      </ul>
    </nav>
  </header>
  <!-- Hero Section -->
  <section class="hero" id="hero">
    <h2 class="hero_header">YOUR VISION   <span class="light">OUR FLIGHT</span></h2>
    <p class="tagline">CERTIFIED RPAS OPERATORS FOR ADVANCED GEOSPATIAL DATA AQUISITION</p>
  </section>
  <!-- Map Section -->
  <section class="map-section" id="map">
    <p style="map-instructions"> &nbsp;&nbsp;Initiate Flight Request </p>
    <div class="search-container">
      <input type="text" id="addressInput" placeholder="Enter address (e.g., Nanaimo, BC)" />
      <button id="searchButton">Search</button>
    </div>
    <div id="mapid"></div>
  </section>
  <!-- Request Section -->
  <section class="request-section">
    <div class="button-container">
      <button class="request-button" onclick="handleRequest('Search and Rescue Request')" disabled="true">Search and Rescue Request</button>
      <button class="request-button" onclick="handleRequest('Construction Site Monitoring Request')" disabled="true">Construction Site Monitoring Request</button>
      <button class="request-button" onclick="handleRequest('Real Estate Request')" disabled="true">Real Estate Request</button>
      <button class="request-button" onclick="handleRequest('Create a Digital Twin Request')" disabled="true">Create a Digital Twin Request</button>
    </div>
  </section>
  <!-- About Section -->
  <section class="about" id="about">
    <h2 class="hidden">About</h2>
    <div class="about-column">
      <img src="images/drone_mapping.jpg" alt="Drone performing aerial mapping" width="400" height="200" class="cards"/>
      <p class="text_column">At DRONEMARK, we specialize in advanced geospatial data acquisition using state-of-the-art RPAS technology. Our certified operators deliver precise aerial mapping and surveying solutions, ensuring high-quality data for industries like construction, agriculture, and environmental monitoring. Trust us to elevate your projects with unparalleled accuracy and efficiency.</p>
    </div>
    <div class="about-column">
      <img src="images/topographic_survey.png" alt="Topographic survey by drone" width="400" height="200" class="cards"/>
      <p class="text_column">Our team at DRONEMARK combines expertise with cutting-edge drone technology to provide tailored geospatial solutions. From 3D modeling to topographic surveys, we offer comprehensive data collection services. Our commitment to safety and regulatory compliance guarantees reliable results, empowering your business with actionable insights from above.</p>
    </div>
    <div class="about-column">
      <img src="images/aerial_imagery.jpg" alt="High-resolution aerial imagery" width="400" height="200" class="cards"/>
      <p class="text_column">DRONEMARK is dedicated to transforming how you see the world. Our RPAS operations deliver detailed geospatial data, supporting urban planning, infrastructure development, and resource management. With a focus on innovation and precision, we help clients make informed decisions through high-resolution aerial imagery and analytics.</p>
    </div>
  </section>
  <!-- Stats Gallery Section -->
  <div class="gallery">
    <div class="thumbnail">
      <h1 class="stats">1500</h1>
      <h4>TITLE</h4>
      <p>One line description</p>
    </div>
    <div class="thumbnail">
      <h1 class="stats">2300</h1>
      <h4>TITLE</h4>
      <p>One line description</p>
    </div>
    <div class="thumbnail">
      <h1 class="stats">7500</h1>
      <h4>TITLE</h4>
      <p>One line description</p>
    </div>
    <div class="thumbnail">
      <h1 class="stats">9870</h1>
      <h4>TITLE</h4>
      <p>One line description</p>
    </div>
  </div>
  <!-- Parallax Section -->
  <section class="banner">
    <h2 class="parallax">PARALLAX HERO</h2>
    <p class="parallax_description">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p>
  </section>
  <!-- More Info Section -->
  <footer>
    <article class="footer_column">
      <h3>ABOUT</h3>
      <img src="images/placeholder.jpg" alt="" width="400" height="200" class="cards"/>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </article>
    <article class="footer_column">
      <h3>LOCATION</h3>
      <img src="images/placeholder.jpg" alt="" width="200" class="cards"/>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </article>
  </footer>
  <!-- Footer Section -->
  <section class="footer_banner" id="contact">
    <h2 class="hidden">Footer Banner Section </h2>
    <p class="hero_header">FOR THE LATEST NEWS & UPDATES</p>
    <div class="button">subscribe</div>
  </section>
  <!-- Copyrights Section -->
  <div class="copyright">©2024 - <strong>Light Theme</strong></div>
</div>
<!-- Main Container Ends -->
<script>
  // Initialize Leaflet map with scrollWheelZoom disabled
  var map = L.map('mapid', {
    scrollWheelZoom: false
  }).setView([49.167, -123.933], 9);

  // Define base layers
  var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
    maxZoom: 18
  }).addTo(map); // Default layer

  var satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    attribution: 'Tiles © Esri — Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
    maxZoom: 18
  });

  var topoLayer = L.tileLayer('https://tile.opentopomap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data: © <a href="http://osm.org/copyright">OpenStreetMap</a> contributors, SRTM | Map style: © <a href="https://opentopomap.org">OpenTopoMap</a> (CC-BY-SA)',
    maxZoom: 17
  });

  var hotLayer = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
    attribution: '© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/">Humanitarian OpenStreetMap Team</a>',
    maxZoom: 18
  });

  // Add layer control
  var baseLayers = {
    "Map View": osmLayer,
    "Satellite View": satelliteLayer,
    "Topographic View": topoLayer,
    "Humanitarian View": hotLayer
  };
  L.control.layers(baseLayers).addTo(map);

  // Enable scrollWheelZoom after map click
  map.on('click', function() {
    map.scrollWheelZoom.enable();
  });

  // Variable to store the current marker
  var currentMarker = null;

  // Geocoding function using Nominatim
  function geocodeAddress(address) {
    console.log('Geocoding address:', address); // Debug: Log address
    fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(address)}&format=json&limit=1`, {
      headers: {
        'User-Agent': 'DRONEMARK/1.0 (contact@example.com)'
      }
    })
    .then(response => {
      console.log('Fetch response status:', response.status); // Debug: Log response status
      return response.json();
    })
    .then(data => {
      console.log('Geocoding data:', data); // Debug: Log response data
      if (data.length > 0) {
        const lat = parseFloat(data[0].lat);
        const lon = parseFloat(data[0].lon);
        console.log('Valid address found:', { lat, lon }); // Debug: Log coordinates
        // Center the map on the address
        map.setView([lat, lon], 16); // Zoom to street level

        // Remove previous marker if it exists
        if (currentMarker) {
          map.removeLayer(currentMarker);
        }

        // Add new marker with popup
        currentMarker = L.marker([lat, lon]).addTo(map)
          .bindPopup(address)
          .openPopup();

        // Enable request buttons
        const buttons = document.querySelectorAll('.request-button');
        console.log('Found buttons:', buttons.length); // Debug: Log number of buttons
        buttons.forEach(button => {
          button.disabled = false;
          console.log('Enabled button:', button.textContent); // Debug: Log enabled button
        });
      } else {
        console.log('No address found'); // Debug: Log no results
        alert('Address not found. Please try a different address.');
      }
    })
    .catch(error => {
      console.error('Geocoding error:', error); // Debug: Log error
      alert('An error occurred while searching. Please try again.');
    });
  }

  // Event listeners for search
  const addressInput = document.getElementById('addressInput');
  const searchButton = document.getElementById('searchButton');

  // Search on button click
  searchButton.addEventListener('click', () => {
    const address = addressInput.value.trim();
    console.log('Search button clicked, address:', address); // Debug: Log click
    if (address) {
      geocodeAddress(address);
    } else {
      alert('Please enter an address.');
    }
  });

  // Search on Enter key press
  addressInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      const address = addressInput.value.trim();
      console.log('Enter key pressed, address:', address); // Debug: Log Enter
      if (address) {
        geocodeAddress(address);
      } else {
        alert('Please enter an address.');
      }
    }
  });

  // Placeholder function for request buttons
  function handleRequest(requestType) {
    console.log(`${requestType} clicked`);
    alert(`${requestType} submitted! (Placeholder action)`);
  }
</script>
</body>
</html>